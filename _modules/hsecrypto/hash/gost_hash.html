<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>hsecrypto.hash.gost_hash &#8212; hse_dsa 0.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../../../_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=27fed22d" />
    <script src="../../../_static/documentation_options.js?v=01f34227"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for hsecrypto.hash.gost_hash</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">struct</span>

<span class="n">C</span> <span class="o">=</span> <span class="p">[</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span>
        <span class="s2">&quot;b1085bda1ecadae9ebcb2f81c0657c1f2f6a76432e45d016714eb88d7585c4fc4b7ce09192676901a2422a08a460d31505767436cc744d23dd806559f2a64507&quot;</span>
    <span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span>
        <span class="s2">&quot;6fa3b58aa99d2f1a4fe39d460f70b5d7f3feea720a232b9861d55e0f16b501319ab5176b12d699585cb561c2db0aa7ca55dda21bd7cbcd56e679047021b19bb7&quot;</span>
    <span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span>
        <span class="s2">&quot;f574dcac2bce2fc70a39fc286a3d843506f15e5f529c1f8bf2ea7514b1297b7bd3e20fe490359eb1c1c93a376062db09c2b6f443867adb31991e96f50aba0ab2&quot;</span>
    <span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span>
        <span class="s2">&quot;ef1fdfb3e81566d2f948e1a05d71e4dd488e857e335c3c7d9d721cad685e353fa9d72c82ed03d675d8b71333935203be3453eaa193e837f1220cbebc84e3d12e&quot;</span>
    <span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span>
        <span class="s2">&quot;4bea6bacad4747999a3f410c6ca923637f151c1f1686104a359e35d7800fffbdbfcd1747253af5a3dfff00b723271a167a56a27ea9ea63f5601758fd7c6cfe57&quot;</span>
    <span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span>
        <span class="s2">&quot;ae4faeae1d3ad3d96fa4c33b7a3039c02d66c4f95142a46c187f9ab49af08ec6cffaa6b71c9ab7b40af21f66c2bec6b6bf71c57236904f35fa68407a46647d6e&quot;</span>
    <span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span>
        <span class="s2">&quot;f4c70e16eeaac5ec51ac86febf240954399ec6c7e6bf87c9d3473e33197a93c90992abc52d822c3706476983284a05043517454ca23c4af38886564d3a14d493&quot;</span>
    <span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span>
        <span class="s2">&quot;9b1f5b424d93c9a703e7aa020c6e41414eb7f8719c36de1e89b4443b4ddbc49af4892bcb929b069069d18d2bd1a5c42f36acc2355951a8d9a47f0dd4bf02e71e&quot;</span>
    <span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span>
        <span class="s2">&quot;378f5a541631229b944c9ad8ec165fde3a7d3a1b258942243cd955b7e00d0984800a440bdbb2ceb17b2b8a9aa6079c540e38dc92cb1f2a607261445183235adb&quot;</span>
    <span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span>
        <span class="s2">&quot;abbedea680056f52382ae548b2e4f3f38941e71cff8a78db1fffe18a1b3361039fe76702af69334b7a1e6c303b7652f43698fad1153bb6c374b4c7fb98459ced&quot;</span>
    <span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span>
        <span class="s2">&quot;7bcd9ed0efc889fb3002c6cd635afe94d8fa6bbbebab076120018021148466798a1d71efea48b9caefbacd1d7d476e98dea2594ac06fd85d6bcaa4cd81f32d1b&quot;</span>
    <span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span>
        <span class="s2">&quot;378ee767f11631bad21380b00449b17acda43c32bcdf1d77f82012d430219f9b5d80ef9d1891cc86e71da4aa88e12852faf417d5d9b21b9948bc924af11bd720&quot;</span>
    <span class="p">),</span>
<span class="p">]</span>

<span class="n">A</span> <span class="o">=</span> <span class="p">[</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;8E20FAA72BA0B470&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;47107DDD9B505A38&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;AD08B0E0C3282D1C&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;D8045870EF14980E&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;6C022C38F90A4C07&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;3601161CF205268D&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;1B8E0B0E798C13C8&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;83478B07B2468764&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;A011D380818E8F40&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;5086E740CE47C920&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;2843FD2067ADEA10&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;14AFF010BDD87508&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;0AD97808D06CB404&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;05E23C0468365A02&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;8C711E02341B2D01&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;46B60F011A83988E&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;90DAB52A387AE76F&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;486DD4151C3DFDB9&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;24B86A840E90F0D2&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;125C354207487869&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;092E94218D243CBA&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;8A174A9EC8121E5D&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;4585254F64090FA0&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;ACCC9CA9328A8950&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;9D4DF05D5F661451&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;C0A878A0A1330AA6&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;60543C50DE970553&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;302A1E286FC58CA7&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;18150F14B9EC46DD&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;0C84890AD27623E0&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;0642CA05693B9F70&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;0321658CBA93C138&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;86275DF09CE8AAA8&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;439DA0784E745554&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;AFC0503C273AA42A&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;D960281E9D1D5215&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;E230140FC0802984&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;71180A8960409A42&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;B60C05CA30204D21&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;5B068C651810A89E&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;456C34887A3805B9&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;AC361A443D1C8CD2&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;561B0D22900E4669&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;2B838811480723BA&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;9BCF4486248D9F5D&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;C3E9224312C8C1A0&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;EFFA11AF0964EE50&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;F97D86D98A327728&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;E4FA2054A80B329C&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;727D102A548B194E&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;39B008152ACB8227&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;9258048415EB419D&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;492C024284FBAEC0&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;AA16012142F35760&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;550B8E9E21F7A530&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;A48B474F9EF5DC18&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;70A6A56E2440598E&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;3853DC371220A247&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;1CA76E95091051AD&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;0EDD37C48A08A6D8&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;07E095624504536C&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;8D70C431AC02A736&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;C83862965601DD1B&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;641C314B2B8EE083&quot;</span><span class="p">),</span>
<span class="p">]</span>

<span class="n">PI</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mi">252</span><span class="p">,</span>
    <span class="mi">238</span><span class="p">,</span>
    <span class="mi">221</span><span class="p">,</span>
    <span class="mi">17</span><span class="p">,</span>
    <span class="mi">207</span><span class="p">,</span>
    <span class="mi">110</span><span class="p">,</span>
    <span class="mi">49</span><span class="p">,</span>
    <span class="mi">22</span><span class="p">,</span>
    <span class="mi">251</span><span class="p">,</span>
    <span class="mi">196</span><span class="p">,</span>
    <span class="mi">250</span><span class="p">,</span>
    <span class="mi">218</span><span class="p">,</span>
    <span class="mi">35</span><span class="p">,</span>
    <span class="mi">197</span><span class="p">,</span>
    <span class="mi">4</span><span class="p">,</span>
    <span class="mi">77</span><span class="p">,</span>
    <span class="mi">233</span><span class="p">,</span>
    <span class="mi">119</span><span class="p">,</span>
    <span class="mi">240</span><span class="p">,</span>
    <span class="mi">219</span><span class="p">,</span>
    <span class="mi">147</span><span class="p">,</span>
    <span class="mi">46</span><span class="p">,</span>
    <span class="mi">153</span><span class="p">,</span>
    <span class="mi">186</span><span class="p">,</span>
    <span class="mi">23</span><span class="p">,</span>
    <span class="mi">54</span><span class="p">,</span>
    <span class="mi">241</span><span class="p">,</span>
    <span class="mi">187</span><span class="p">,</span>
    <span class="mi">20</span><span class="p">,</span>
    <span class="mi">205</span><span class="p">,</span>
    <span class="mi">95</span><span class="p">,</span>
    <span class="mi">193</span><span class="p">,</span>
    <span class="mi">249</span><span class="p">,</span>
    <span class="mi">24</span><span class="p">,</span>
    <span class="mi">101</span><span class="p">,</span>
    <span class="mi">90</span><span class="p">,</span>
    <span class="mi">226</span><span class="p">,</span>
    <span class="mi">92</span><span class="p">,</span>
    <span class="mi">239</span><span class="p">,</span>
    <span class="mi">33</span><span class="p">,</span>
    <span class="mi">129</span><span class="p">,</span>
    <span class="mi">28</span><span class="p">,</span>
    <span class="mi">60</span><span class="p">,</span>
    <span class="mi">66</span><span class="p">,</span>
    <span class="mi">139</span><span class="p">,</span>
    <span class="mi">1</span><span class="p">,</span>
    <span class="mi">142</span><span class="p">,</span>
    <span class="mi">79</span><span class="p">,</span>
    <span class="mi">5</span><span class="p">,</span>
    <span class="mi">132</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">,</span>
    <span class="mi">174</span><span class="p">,</span>
    <span class="mi">227</span><span class="p">,</span>
    <span class="mi">106</span><span class="p">,</span>
    <span class="mi">143</span><span class="p">,</span>
    <span class="mi">160</span><span class="p">,</span>
    <span class="mi">6</span><span class="p">,</span>
    <span class="mi">11</span><span class="p">,</span>
    <span class="mi">237</span><span class="p">,</span>
    <span class="mi">152</span><span class="p">,</span>
    <span class="mi">127</span><span class="p">,</span>
    <span class="mi">212</span><span class="p">,</span>
    <span class="mi">211</span><span class="p">,</span>
    <span class="mi">31</span><span class="p">,</span>
    <span class="mi">235</span><span class="p">,</span>
    <span class="mi">52</span><span class="p">,</span>
    <span class="mi">44</span><span class="p">,</span>
    <span class="mi">81</span><span class="p">,</span>
    <span class="mi">234</span><span class="p">,</span>
    <span class="mi">200</span><span class="p">,</span>
    <span class="mi">72</span><span class="p">,</span>
    <span class="mi">171</span><span class="p">,</span>
    <span class="mi">242</span><span class="p">,</span>
    <span class="mi">42</span><span class="p">,</span>
    <span class="mi">104</span><span class="p">,</span>
    <span class="mi">162</span><span class="p">,</span>
    <span class="mi">253</span><span class="p">,</span>
    <span class="mi">58</span><span class="p">,</span>
    <span class="mi">206</span><span class="p">,</span>
    <span class="mi">204</span><span class="p">,</span>
    <span class="mi">181</span><span class="p">,</span>
    <span class="mi">112</span><span class="p">,</span>
    <span class="mi">14</span><span class="p">,</span>
    <span class="mi">86</span><span class="p">,</span>
    <span class="mi">8</span><span class="p">,</span>
    <span class="mi">12</span><span class="p">,</span>
    <span class="mi">118</span><span class="p">,</span>
    <span class="mi">18</span><span class="p">,</span>
    <span class="mi">191</span><span class="p">,</span>
    <span class="mi">114</span><span class="p">,</span>
    <span class="mi">19</span><span class="p">,</span>
    <span class="mi">71</span><span class="p">,</span>
    <span class="mi">156</span><span class="p">,</span>
    <span class="mi">183</span><span class="p">,</span>
    <span class="mi">93</span><span class="p">,</span>
    <span class="mi">135</span><span class="p">,</span>
    <span class="mi">21</span><span class="p">,</span>
    <span class="mi">161</span><span class="p">,</span>
    <span class="mi">150</span><span class="p">,</span>
    <span class="mi">41</span><span class="p">,</span>
    <span class="mi">16</span><span class="p">,</span>
    <span class="mi">123</span><span class="p">,</span>
    <span class="mi">154</span><span class="p">,</span>
    <span class="mi">199</span><span class="p">,</span>
    <span class="mi">243</span><span class="p">,</span>
    <span class="mi">145</span><span class="p">,</span>
    <span class="mi">120</span><span class="p">,</span>
    <span class="mi">111</span><span class="p">,</span>
    <span class="mi">157</span><span class="p">,</span>
    <span class="mi">158</span><span class="p">,</span>
    <span class="mi">178</span><span class="p">,</span>
    <span class="mi">177</span><span class="p">,</span>
    <span class="mi">50</span><span class="p">,</span>
    <span class="mi">117</span><span class="p">,</span>
    <span class="mi">25</span><span class="p">,</span>
    <span class="mi">61</span><span class="p">,</span>
    <span class="mi">255</span><span class="p">,</span>
    <span class="mi">53</span><span class="p">,</span>
    <span class="mi">138</span><span class="p">,</span>
    <span class="mi">126</span><span class="p">,</span>
    <span class="mi">109</span><span class="p">,</span>
    <span class="mi">84</span><span class="p">,</span>
    <span class="mi">198</span><span class="p">,</span>
    <span class="mi">128</span><span class="p">,</span>
    <span class="mi">195</span><span class="p">,</span>
    <span class="mi">189</span><span class="p">,</span>
    <span class="mi">13</span><span class="p">,</span>
    <span class="mi">87</span><span class="p">,</span>
    <span class="mi">223</span><span class="p">,</span>
    <span class="mi">245</span><span class="p">,</span>
    <span class="mi">36</span><span class="p">,</span>
    <span class="mi">169</span><span class="p">,</span>
    <span class="mi">62</span><span class="p">,</span>
    <span class="mi">168</span><span class="p">,</span>
    <span class="mi">67</span><span class="p">,</span>
    <span class="mi">201</span><span class="p">,</span>
    <span class="mi">215</span><span class="p">,</span>
    <span class="mi">121</span><span class="p">,</span>
    <span class="mi">214</span><span class="p">,</span>
    <span class="mi">246</span><span class="p">,</span>
    <span class="mi">124</span><span class="p">,</span>
    <span class="mi">34</span><span class="p">,</span>
    <span class="mi">185</span><span class="p">,</span>
    <span class="mi">3</span><span class="p">,</span>
    <span class="mi">224</span><span class="p">,</span>
    <span class="mi">15</span><span class="p">,</span>
    <span class="mi">236</span><span class="p">,</span>
    <span class="mi">222</span><span class="p">,</span>
    <span class="mi">122</span><span class="p">,</span>
    <span class="mi">148</span><span class="p">,</span>
    <span class="mi">176</span><span class="p">,</span>
    <span class="mi">188</span><span class="p">,</span>
    <span class="mi">220</span><span class="p">,</span>
    <span class="mi">232</span><span class="p">,</span>
    <span class="mi">40</span><span class="p">,</span>
    <span class="mi">80</span><span class="p">,</span>
    <span class="mi">78</span><span class="p">,</span>
    <span class="mi">51</span><span class="p">,</span>
    <span class="mi">10</span><span class="p">,</span>
    <span class="mi">74</span><span class="p">,</span>
    <span class="mi">167</span><span class="p">,</span>
    <span class="mi">151</span><span class="p">,</span>
    <span class="mi">96</span><span class="p">,</span>
    <span class="mi">115</span><span class="p">,</span>
    <span class="mi">30</span><span class="p">,</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mi">98</span><span class="p">,</span>
    <span class="mi">68</span><span class="p">,</span>
    <span class="mi">26</span><span class="p">,</span>
    <span class="mi">184</span><span class="p">,</span>
    <span class="mi">56</span><span class="p">,</span>
    <span class="mi">130</span><span class="p">,</span>
    <span class="mi">100</span><span class="p">,</span>
    <span class="mi">159</span><span class="p">,</span>
    <span class="mi">38</span><span class="p">,</span>
    <span class="mi">65</span><span class="p">,</span>
    <span class="mi">173</span><span class="p">,</span>
    <span class="mi">69</span><span class="p">,</span>
    <span class="mi">70</span><span class="p">,</span>
    <span class="mi">146</span><span class="p">,</span>
    <span class="mi">39</span><span class="p">,</span>
    <span class="mi">94</span><span class="p">,</span>
    <span class="mi">85</span><span class="p">,</span>
    <span class="mi">47</span><span class="p">,</span>
    <span class="mi">140</span><span class="p">,</span>
    <span class="mi">163</span><span class="p">,</span>
    <span class="mi">165</span><span class="p">,</span>
    <span class="mi">125</span><span class="p">,</span>
    <span class="mi">105</span><span class="p">,</span>
    <span class="mi">213</span><span class="p">,</span>
    <span class="mi">149</span><span class="p">,</span>
    <span class="mi">59</span><span class="p">,</span>
    <span class="mi">7</span><span class="p">,</span>
    <span class="mi">88</span><span class="p">,</span>
    <span class="mi">179</span><span class="p">,</span>
    <span class="mi">64</span><span class="p">,</span>
    <span class="mi">134</span><span class="p">,</span>
    <span class="mi">172</span><span class="p">,</span>
    <span class="mi">29</span><span class="p">,</span>
    <span class="mi">247</span><span class="p">,</span>
    <span class="mi">48</span><span class="p">,</span>
    <span class="mi">55</span><span class="p">,</span>
    <span class="mi">107</span><span class="p">,</span>
    <span class="mi">228</span><span class="p">,</span>
    <span class="mi">136</span><span class="p">,</span>
    <span class="mi">217</span><span class="p">,</span>
    <span class="mi">231</span><span class="p">,</span>
    <span class="mi">137</span><span class="p">,</span>
    <span class="mi">225</span><span class="p">,</span>
    <span class="mi">27</span><span class="p">,</span>
    <span class="mi">131</span><span class="p">,</span>
    <span class="mi">73</span><span class="p">,</span>
    <span class="mi">76</span><span class="p">,</span>
    <span class="mi">63</span><span class="p">,</span>
    <span class="mi">248</span><span class="p">,</span>
    <span class="mi">254</span><span class="p">,</span>
    <span class="mi">141</span><span class="p">,</span>
    <span class="mi">83</span><span class="p">,</span>
    <span class="mi">170</span><span class="p">,</span>
    <span class="mi">144</span><span class="p">,</span>
    <span class="mi">202</span><span class="p">,</span>
    <span class="mi">216</span><span class="p">,</span>
    <span class="mi">133</span><span class="p">,</span>
    <span class="mi">97</span><span class="p">,</span>
    <span class="mi">32</span><span class="p">,</span>
    <span class="mi">113</span><span class="p">,</span>
    <span class="mi">103</span><span class="p">,</span>
    <span class="mi">164</span><span class="p">,</span>
    <span class="mi">45</span><span class="p">,</span>
    <span class="mi">43</span><span class="p">,</span>
    <span class="mi">9</span><span class="p">,</span>
    <span class="mi">91</span><span class="p">,</span>
    <span class="mi">203</span><span class="p">,</span>
    <span class="mi">155</span><span class="p">,</span>
    <span class="mi">37</span><span class="p">,</span>
    <span class="mi">208</span><span class="p">,</span>
    <span class="mi">190</span><span class="p">,</span>
    <span class="mi">229</span><span class="p">,</span>
    <span class="mi">108</span><span class="p">,</span>
    <span class="mi">82</span><span class="p">,</span>
    <span class="mi">89</span><span class="p">,</span>
    <span class="mi">166</span><span class="p">,</span>
    <span class="mi">116</span><span class="p">,</span>
    <span class="mi">210</span><span class="p">,</span>
    <span class="mi">230</span><span class="p">,</span>
    <span class="mi">244</span><span class="p">,</span>
    <span class="mi">180</span><span class="p">,</span>
    <span class="mi">192</span><span class="p">,</span>
    <span class="mi">209</span><span class="p">,</span>
    <span class="mi">102</span><span class="p">,</span>
    <span class="mi">175</span><span class="p">,</span>
    <span class="mi">194</span><span class="p">,</span>
    <span class="mi">57</span><span class="p">,</span>
    <span class="mi">75</span><span class="p">,</span>
    <span class="mi">99</span><span class="p">,</span>
    <span class="mi">182</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">T</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mi">8</span><span class="p">,</span>
    <span class="mi">16</span><span class="p">,</span>
    <span class="mi">24</span><span class="p">,</span>
    <span class="mi">32</span><span class="p">,</span>
    <span class="mi">40</span><span class="p">,</span>
    <span class="mi">48</span><span class="p">,</span>
    <span class="mi">56</span><span class="p">,</span>
    <span class="mi">1</span><span class="p">,</span>
    <span class="mi">9</span><span class="p">,</span>
    <span class="mi">17</span><span class="p">,</span>
    <span class="mi">25</span><span class="p">,</span>
    <span class="mi">33</span><span class="p">,</span>
    <span class="mi">41</span><span class="p">,</span>
    <span class="mi">49</span><span class="p">,</span>
    <span class="mi">57</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">,</span>
    <span class="mi">10</span><span class="p">,</span>
    <span class="mi">18</span><span class="p">,</span>
    <span class="mi">26</span><span class="p">,</span>
    <span class="mi">34</span><span class="p">,</span>
    <span class="mi">42</span><span class="p">,</span>
    <span class="mi">50</span><span class="p">,</span>
    <span class="mi">58</span><span class="p">,</span>
    <span class="mi">3</span><span class="p">,</span>
    <span class="mi">11</span><span class="p">,</span>
    <span class="mi">19</span><span class="p">,</span>
    <span class="mi">27</span><span class="p">,</span>
    <span class="mi">35</span><span class="p">,</span>
    <span class="mi">43</span><span class="p">,</span>
    <span class="mi">51</span><span class="p">,</span>
    <span class="mi">59</span><span class="p">,</span>
    <span class="mi">4</span><span class="p">,</span>
    <span class="mi">12</span><span class="p">,</span>
    <span class="mi">20</span><span class="p">,</span>
    <span class="mi">28</span><span class="p">,</span>
    <span class="mi">36</span><span class="p">,</span>
    <span class="mi">44</span><span class="p">,</span>
    <span class="mi">52</span><span class="p">,</span>
    <span class="mi">60</span><span class="p">,</span>
    <span class="mi">5</span><span class="p">,</span>
    <span class="mi">13</span><span class="p">,</span>
    <span class="mi">21</span><span class="p">,</span>
    <span class="mi">29</span><span class="p">,</span>
    <span class="mi">37</span><span class="p">,</span>
    <span class="mi">45</span><span class="p">,</span>
    <span class="mi">53</span><span class="p">,</span>
    <span class="mi">61</span><span class="p">,</span>
    <span class="mi">6</span><span class="p">,</span>
    <span class="mi">14</span><span class="p">,</span>
    <span class="mi">22</span><span class="p">,</span>
    <span class="mi">30</span><span class="p">,</span>
    <span class="mi">38</span><span class="p">,</span>
    <span class="mi">46</span><span class="p">,</span>
    <span class="mi">54</span><span class="p">,</span>
    <span class="mi">62</span><span class="p">,</span>
    <span class="mi">7</span><span class="p">,</span>
    <span class="mi">15</span><span class="p">,</span>
    <span class="mi">23</span><span class="p">,</span>
    <span class="mi">31</span><span class="p">,</span>
    <span class="mi">39</span><span class="p">,</span>
    <span class="mi">47</span><span class="p">,</span>
    <span class="mi">55</span><span class="p">,</span>
    <span class="mi">63</span><span class="p">,</span>
<span class="p">]</span>


<div class="viewcode-block" id="GostHash">
<a class="viewcode-back" href="../../../hsecrypto.hash.html#hsecrypto.hash.gost_hash.GostHash">[docs]</a>
<span class="k">class</span> <span class="nc">GostHash</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">is_256</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="n">message</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_256</span> <span class="o">=</span> <span class="n">is_256</span>

<div class="viewcode-block" id="GostHash.xor">
<a class="viewcode-back" href="../../../hsecrypto.hash.html#hsecrypto.hash.gost_hash.GostHash.xor">[docs]</a>
    <span class="k">def</span> <span class="nf">xor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">i</span> <span class="o">^</span> <span class="n">j</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span></div>


<div class="viewcode-block" id="GostHash.S">
<a class="viewcode-back" href="../../../hsecrypto.hash.html#hsecrypto.hash.gost_hash.GostHash.S">[docs]</a>
    <span class="k">def</span> <span class="nf">S</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">PI</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">x</span><span class="p">)</span></div>


<div class="viewcode-block" id="GostHash.P">
<a class="viewcode-back" href="../../../hsecrypto.hash.html#hsecrypto.hash.gost_hash.GostHash.P">[docs]</a>
    <span class="k">def</span> <span class="nf">P</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">64</span><span class="p">))</span></div>


<div class="viewcode-block" id="GostHash.L">
<a class="viewcode-back" href="../../../hsecrypto.hash.html#hsecrypto.hash.gost_hash.GostHash.L">[docs]</a>
    <span class="k">def</span> <span class="nf">L</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
        <span class="n">input_u64</span> <span class="o">=</span> <span class="p">[</span>
            <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">8</span><span class="p">],</span> <span class="n">byteorder</span><span class="o">=</span><span class="s2">&quot;big&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="n">buffers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">8</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">64</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">input_u64</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="n">j</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">buffers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^=</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">63</span> <span class="o">-</span> <span class="n">j</span><span class="p">])</span>

        <span class="n">buffer</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s2">&quot;&gt;Q&quot;</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">buffers</span><span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">64</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">byte</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">buffer</span><span class="p">):</span>
            <span class="n">res</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">byte</span>

        <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">res</span><span class="p">)</span></div>


<div class="viewcode-block" id="GostHash.X">
<a class="viewcode-back" href="../../../hsecrypto.hash.html#hsecrypto.hash.gost_hash.GostHash.X">[docs]</a>
    <span class="k">def</span> <span class="nf">X</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">xor</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span></div>


<div class="viewcode-block" id="GostHash.E">
<a class="viewcode-back" href="../../../hsecrypto.hash.html#hsecrypto.hash.gost_hash.GostHash.E">[docs]</a>
    <span class="k">def</span> <span class="nf">E</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
        <span class="n">Ks</span> <span class="o">=</span> <span class="p">[</span><span class="n">K</span><span class="p">]</span> <span class="o">*</span> <span class="mi">13</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">):</span>
            <span class="n">Ks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">S</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xor</span><span class="p">(</span><span class="n">Ks</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">C</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]))))</span>
        <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">S</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="n">Ks</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">m</span><span class="p">))))</span>
        <span class="n">es</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">):</span>
            <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">S</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="n">Ks</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">e</span><span class="p">))))</span>
            <span class="n">es</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="n">Ks</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">e</span></div>


<div class="viewcode-block" id="GostHash.g_n">
<a class="viewcode-back" href="../../../hsecrypto.hash.html#hsecrypto.hash.gost_hash.GostHash.g_n">[docs]</a>
    <span class="k">def</span> <span class="nf">g_n</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
        <span class="n">K</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">S</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xor</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">N</span><span class="p">))))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">xor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">E</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">m</span><span class="p">),</span> <span class="n">h</span><span class="p">),</span> <span class="n">m</span><span class="p">)</span></div>


<div class="viewcode-block" id="GostHash.MSB">
<a class="viewcode-back" href="../../../hsecrypto.hash.html#hsecrypto.hash.gost_hash.GostHash.MSB">[docs]</a>
    <span class="k">def</span> <span class="nf">MSB</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">256</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">z</span><span class="p">[</span><span class="n">n</span> <span class="o">//</span> <span class="mi">8</span> <span class="p">:]</span></div>


<div class="viewcode-block" id="GostHash.hash">
<a class="viewcode-back" href="../../../hsecrypto.hash.html#hsecrypto.hash.gost_hash.GostHash.hash">[docs]</a>
    <span class="k">def</span> <span class="nf">hash</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">h</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span> <span class="o">*</span> <span class="mi">64</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_256</span> <span class="k">else</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x01</span><span class="s2">&quot;</span> <span class="o">*</span> <span class="mi">64</span>
        <span class="n">N</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span> <span class="o">*</span> <span class="mi">64</span>
        <span class="n">S</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span> <span class="o">*</span> <span class="mi">64</span>

        <span class="n">M</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">message</span>

        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">64</span><span class="p">:</span>
            <span class="n">block</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">64</span><span class="p">:]</span>
            <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">g_n</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">block</span><span class="p">)</span>
            <span class="n">Nint</span> <span class="o">=</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">*</span> <span class="mi">8</span>
            <span class="n">N</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">Nint</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">128</span><span class="p">))</span>
            <span class="n">Sint</span> <span class="o">=</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">S</span><span class="p">)</span> <span class="o">+</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
            <span class="n">S</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">Sint</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">128</span><span class="p">))</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">M</span><span class="p">[:</span><span class="o">-</span><span class="mi">64</span><span class="p">]</span>
        <span class="n">m</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span> <span class="o">*</span> <span class="p">(</span><span class="mi">63</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">M</span><span class="p">))</span> <span class="o">+</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x01</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">M</span>
        <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">g_n</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
        <span class="n">Nint</span> <span class="o">=</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">*</span> <span class="mi">8</span>
        <span class="n">N</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">Nint</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">128</span><span class="p">))</span>
        <span class="n">Sint</span> <span class="o">=</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">S</span><span class="p">)</span> <span class="o">+</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="n">S</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">Sint</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">128</span><span class="p">))</span>
        <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">g_n</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span> <span class="o">*</span> <span class="mi">64</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>

        <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">g_n</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span> <span class="o">*</span> <span class="mi">64</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">S</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_256</span><span class="p">:</span>
            <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">MSB</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">h</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span></div>
</div>



<span class="c1"># h = GostHash(message=bytes.fromhex(&quot;323130393837363534333231303938373635343332313039383736353433323130393837363534333231303938373635343332313039383736353433323130&quot;), is_256=True)</span>
<span class="c1"># print(h.hash())</span>
<span class="c1"># # print(h.L(bytes.fromhex(&quot;fcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfcfc&quot;)).hex())</span>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">hse_dsa</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">HSE_DSA</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Morzan6.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.1.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
    </div>

    

    
  </body>
</html>